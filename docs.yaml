components:
  parameters:
    page:
      description: Page to retrieve from the entire result set
      in: query
      name: page
      schema:
        default: 1
        minimum: 1
        type: integer
    page[number]:
      description: Page to retrieve from the entire result set
      in: query
      name: page[number]
      schema:
        default: 1
        minimum: 1
        type: integer
    page[size]:
      description: Max amount of objects to return per page in the response
      in: query
      name: page[size]
      schema:
        default: 100
        maximum: 100
        type: integer
    page_size:
      description: Max amount of objects to return per page in the response
      in: query
      name: page_size
      schema:
        default: 100
        maximum: 100
        type: integer
    q:
      description: Apply search to query
      in: query
      name: q
      schema:
        type: string
  responses:
    BadRequestError:
      description: Invalid request sent to endpoint
    ForbiddenError:
      description: Invalid permissions to perform operation
    NotFoundError:
      description: The specified resource was not found
    UnauthorizedError:
      description: Access token is missing or invalid
    UnprocessableEntityError:
      description: Unable to process the contained instructions
  schemas:
    Attribute:
      properties:
        attribute_id:
          type: integer
        value:
          type: string
      required:
      - attribute_id
      - value
      type: object
    CablePath:
      properties:
        a_side:
          readOnly: true
        id:
          readOnly: true
          type: string
        type:
          type: string
        z_side:
          readOnly: true
      type: object
    EPAccessory:
      properties:
        created_at:
          readOnly: true
        description:
          type: string
        id:
          readOnly: true
          type: integer
        labor_hours:
          default: !!python/object/apply:decimal.Decimal
          - 0E-10
          type:
          - number
          - '''null'''
        manufacturer:
          default: ''
          type: string
        model:
          default: ''
          type: string
        price:
          default: !!python/object/apply:decimal.Decimal
          - 0E-10
          type:
          - number
          - '''null'''
      required:
      - description
      type: object
    EPContent:
      properties:
        attribute:
          default: []
          items:
            $ref: '#/components/schemas/Attribute'
          type: array
        child:
          default: []
          items:
            $ref: '#/components/schemas/SubElement'
          type: array
        pdf_url:
          default: []
          items:
            $ref: '#/components/schemas/Link'
          maxItems: 2
          type: array
      type: object
    ElementProfileSchema:
      properties:
        accessories:
          items:
            $ref: '#/components/schemas/EPAccessory'
          type: array
        content:
          $ref: '#/components/schemas/EPContent'
        created_at:
          readOnly: true
        created_by:
          readOnly: true
          type: integer
        element_id:
          type: integer
        id:
          readOnly: true
          type: integer
        is_default:
          type: boolean
        modified_at:
          readOnly: true
        name:
          type: string
        sort:
          type: integer
        team_id:
          type: integer
      required:
      - content
      - element_id
      - name
      - team_id
      type: object
    FolderSchema:
      properties:
        id:
          readOnly: true
          type: string
        label:
          type: string
        name:
          type: string
        site_external_id:
          type: string
          writeOnly: true
        site_id:
          readOnly: true
          type: integer
        team_id:
          type: integer
      required:
      - name
      type: object
    Link:
      properties:
        link_type:
          type: integer
        name:
          type: string
        url:
          format: url
          type: string
      required:
      - link_type
      - name
      - url
      type: object
    PathConnection:
      properties:
        end:
          readOnly: true
        start:
          readOnly: true
      type: object
    ShareSiteOrSurveyRequestSchema:
      properties:
        created_at:
          readOnly: true
          type:
          - '''null'''
        emails:
          items:
            format: email
            type: string
          type: array
        expiration_date: {}
        message:
          type: string
        modified_at:
          readOnly: true
          type:
          - '''null'''
      required:
      - emails
      - expiration_date
      type: object
    SiteSchema:
      properties:
        city:
          maxLength: 250
          type: string
        created_at:
          readOnly: true
          type:
          - '''null'''
        creator:
          allOf:
          - $ref: '#/components/schemas/UserResponse'
          readOnly: true
        is_archived: {}
        label:
          maxLength: 255
          type: string
        legacy_site_id:
          readOnly: true
          type: integer
        modified_at:
          readOnly: true
          type:
          - '''null'''
        modifier:
          allOf:
          - $ref: '#/components/schemas/UserResponse'
          readOnly: true
        name:
          maxLength: 250
          type: string
        reference_id:
          maxLength: 255
          type: string
        site_id:
          type: string
        state:
          maxLength: 250
          type: string
        street:
          maxLength: 250
          type: string
        tags:
          items:
            type: string
          type: array
        team_id:
          type: integer
        version:
          readOnly: true
          type: integer
        zip_code:
          maxLength: 250
          type: string
      required:
      - name
      - team_id
      type: object
    SubElement:
      properties:
        element_id:
          type: string
        systemtype_id:
          type: string
      required:
      - element_id
      - systemtype_id
      type: object
    SurveyAnnotation:
      properties:
        category: {}
        end_point: {}
        font_size:
          type: string
        id:
          readOnly: true
          type: string
        location: {}
        size:
          type: string
        start_point: {}
        stroke_color:
          type: string
        stroke_width:
          type: string
        text:
          type: string
      required:
      - category
      - location
      - stroke_color
      - stroke_width
      type: object
    SurveyAttribute:
      properties:
        attribute_id:
          type: integer
        id:
          readOnly: true
          type: integer
        name:
          type: string
        value:
          type: string
      required:
      - attribute_id
      - name
      - value
      type: object
    SurveyElement:
      properties:
        id:
          readOnly: true
          type: string
        name:
          type: string
        element_id:
          type: integer
        element_profile_id:
          type: integer
        systemtype_id:
          type: integer
        variant: {}
        z_order:
          type: integer
        position: {}
        photo_urls:
          items:
            type: string
          type: array
        pdf_urls:
          items:
            type: object
          type: array
        attributes:
          items:
            $ref: '#/components/schemas/SurveyAttribute'
          type: array
        accessories:
          items:
            $ref: '#/components/schemas/SurveyElementAccessory'
          type: array
        children:
          items:
            $ref: '#/components/schemas/SurveyElement'
          type: array
        cables:
          items:
            $ref: '#/components/schemas/CablePath'
          type: array
        connections:
          $ref: '#/components/schemas/PathConnection'
        activity_log:
          items:
            $ref: '#/components/schemas/SurveyElementActivityLog'
          type: array
      required:
      - element_id
      - name
      - systemtype_id
      type: object
    SurveyElementAccessory:
      properties:
        description:
          type: string
        id:
          readOnly: true
          type: string
        labor_hours:
          type: number
        manufacturer:
          type: string
        model:
          type: string
        price: {}
        quantity: {}
        row_index:
          type: integer
      required:
      - manufacturer
      - model
      - row_index
      type: object
    SurveyElementActivityLog:
      properties:
        date:
          readOnly: true
        entry:
          type: string
        id:
          readOnly: true
          type: string
      type: object
    SurveyFields:
      properties:
        field_id:
          type: string
        value:
          type: string
      required:
      - field_id
      - value
      type: object
    SurveyOptions:
      properties:
        id:
          type: string
        inputs:
          items:
            $ref: '#/components/schemas/SurveyFields'
          type: array
        scope:
          enum:
          - template
          - model
          - content
          type: string
        template_name:
          type: string
        value:
          type: boolean
      required:
      - id
      - scope
      - value
      type: object
    SurveyReportRequestSchema:
      properties:
        custom_data:
          type: object
        filters:
          items:
            type: object
          type: array
        ids:
          items:
            type: string
          type: array
        is_excel:
          default: false
          type: boolean
        is_site_report:
          default: false
          type: boolean
        name:
          type: string
        options:
          items:
            $ref: '#/components/schemas/SurveyOptions'
          type: array
        output:
          enum:
          - pdf
          - html
          - xls
          type: string
        paper_size:
          type: string
        report_id:
          format: uuid
          type: string
        site_id:
          type: string
      required:
      - name
      - output
      - report_id
      - site_id
      type: object
    SurveySchema:
      properties:
        id:
          readOnly: true
          type: string
        title:
          type: string
        label:
          type: string
        reference_id:
          type: string
        description:
          type: string
        summary:
          type: string
        location:
          type: string
        status:
          writeOnly: true
        site:
          readOnly: true
        icon_size:
          type: integer
        is_archived:
          readOnly: true
          type: boolean
        unit: {}
        version:
          readOnly: true
          type: integer
        margin_range:
          type: number
        type:
          readOnly: true
        floorplan_scale:
          type: number
        preview_image:
          type: string
        floorplan_url:
          type: string
        creator:
          readOnly: true
          type: integer
        editor:
          readOnly: true
          type: integer
        modifier:
          readOnly: true
          type: integer
        created_at:
          readOnly: true
        modified_at:
          readOnly: true
        elements:
          items:
            $ref: '#/components/schemas/SurveyElement'
          type: array
        annotations:
          items:
            $ref: '#/components/schemas/SurveyAnnotation'
          type: array
        users:
          readOnly: true
      required:
      - icon_size
      - margin_range
      - title
      - unit
      type: object
    UserResponse:
      properties:
        first_name:
          type: string
        last_name:
          type: string
        user_id:
          type: integer
      required:
      - user_id
      type: object
  securitySchemes:
    jwt:
      bearerFormat: JWT
      scheme: bearer
      type: http
info:
  title: System Surveyor API
  version: 2.0.0
openapi: 3.1.0
paths:
  /v2/refresh_token:
    post:
      operationId: get_refresh_token
      parameters:
      - in: header
        name: CLIENT_INFO
        schema:
          properties:
            platform:
              description: '* `1` - Web

                * `2` - iOS

                * `3` - Android

                '
              enum:
              - 1
              - 2
              - 3
              type: integer
          type: object
      public: true
      requestBody:
        content:
          application/json:
            schema:
              properties:
                refresh_token:
                  example: eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJ0eXBlIjoicmVmcmVzaCIsInJvbGUiOjIsInVzZXJfaWQiOjMwNDcsImV4cCI6MTYyNTkwODg3MywiaWF0IjoxNjI1MzA0MDczfQ.AhgGvP9vyJmwXpo3f1_q3yI1rvP47LFV_UPL9FcGbWKa8tfR9nop6rqSXBRNx1ZflM-rNUbQB63DQqRIXXXvPo0df3u9CQsrcMkNllmBzfoCv_vBlcx0k53CmUz0A9tINF5ypA30i57uUVQmvOf0JEf83-Xi6DkjCf2_e7mzc_Ab4XcYVpRrFUxuV5i1L0OL7U-V9CjcA1J92rzB6ZCPUi9v8vdziOcEdCYZRzGM1oxO07rpZkPj_0KOeuh7ecqW3s51z8R6_Sj8bOz0TuAnrDBmArfzbS3TRrNPBKtADhV62oCbRF8PuNjGZa89V6V_TkJmrZsMCZiHGXRPn63Dig
                  required: true
                  type: string
              type: object
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  refresh_token:
                    example: wqJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJ0eXBlIjoicmVmcmVzaCIsInJvbGUiOjIsInVzZXJfaWQiOjMwNDcsImV4cCI6MTYyNTkwODg3MywiaWF0IjoxNjI1MzA0MDczfQ.AhgGvP9vyJmwXpo3f1_q3yI1rvP47LFV_UPL9FcGbWKa8tfR9nop6rqSXBRNx1ZflM-rNUbQB63DQqRIXXXvPo0df3u9CQsrcMkNllmBzfoCv_vBlcx0k53CmUz0A9tINF5ypA30i57uUVQmvOf0JEf83-Xi6DkjCf2_e7mzc_Ab4XcYVpRrFUxuV5i1L0OL7U-V9CjcA1J92rzB6ZCPUi9v8vdziOcEdCYZRzGM1oxO07rpZkPj_0KOeuh7ecqW3s51z8R6_Sj8bOz0TuAnrDBmArfzbS3TRrNPBKtADhV62oCbRF8PuNjGZa89V6V_TkJmrZsMCZiHGXRPn63Dig
                    type: string
                  token:
                    example: eyJ0eXNiOiJKV1QiXCJhbGciOiJSUzI1NiJ9.eyJ0eXBlIjoicmVmcmVzaCIsInJvbGUiOjIsInVzZXJfaWQiOjMwNDcsImV4cCI6MTYyNTkwODg3MywiaWF0IjoxNjI1MzA0MDczfQ.AhgGvP9vyJmwXpo3f1_q3yI1rvP47LFV_UPL9FcGbWKa8tfR9nop6rqSXBRNx1ZflM-rNUbQB63DQqRIXXXvPo0df3u9CQsrcMkNllmBzfoCv_vBlcx0k53CmUz0A9tINF5ypA30i57uUVQmvOf0JEf83-Xi6DkjCf2_e7mzc_Ab4XcYVpRrFUxuV5i1L0OL7U-V9CjcA1J92rzB6ZCPUi9v8vdziOcEdCYZRzGM1oxO07rpZkPj_0KOeuh7ecqW3s51z8R6_Sj8bOz0TuAnrDBmArfzbS3TRrNPBKtADhV62oCbRF8PuNjGZa89V6V_TkJmrZsMCZiHGXRPn63Dig
                    type: string
                type: object
          description: OK
        '401':
          $ref: '#/components/responses/UnauthorizedError'
      summary: Returns a new valid access token given a valid refresh token
      tags:
      - Authentication
  /v2/site:
    post:
      operationId: create_site
      public: true
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SiteSchema'
        required: true
      responses:
        '201':
          content:
            application/json:
              schema:
                properties:
                  site_id:
                    example: 46787da3-1e6e-4d9b-a858-ac9e12dc3efb
                    type: string
                type: object
          description: OK
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
      summary: Create a new site
      tags:
      - Sites
  /v2/site/{site_id}:
    get:
      description: Response also includes available permissions for the current user
        for the site
      operationId: get_site
      parameters:
      - in: path
        name: site_id
        required: true
        schema:
          example: 14875
          type: integer
      public: true
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  data:
                    properties:
                      city:
                        type: string
                      creator:
                        properties:
                          first_name:
                            type: string
                          last_name:
                            type: string
                          user_id:
                            type: integer
                        type: object
                      current_user_permissions:
                        properties:
                          is_site_guest:
                            type: boolean
                          user_can_change_site_access:
                            type: boolean
                          user_can_create_surveys:
                            type: boolean
                          user_can_delete_surveys:
                            type: boolean
                          user_can_edit_contacts:
                            type: boolean
                          user_can_edit_site:
                            type: boolean
                          user_can_invite_guests:
                            type: boolean
                          user_can_modify_surveys:
                            type: boolean
                          user_can_revoke_survey_edit:
                            type: boolean
                          user_can_view_site_access:
                            description: If user can view team members list
                            type: boolean
                        type: object
                      is_archived:
                        type: boolean
                      label:
                        type: string
                      modifier:
                        properties:
                          first_name:
                            type: string
                          last_name:
                            type: string
                          user_id:
                            type: integer
                        type: object
                      name:
                        type: string
                      reference_id:
                        type: string
                      site_id:
                        example: 46787da3-1e6e-4d9b-a858-ac9e12dc3efb
                        type: string
                      state:
                        type: string
                      street:
                        type: string
                      tags:
                        items:
                          type: string
                        type: array
                      team_id:
                        type: integer
                      version:
                        type: integer
                      zip_code:
                        type: string
                    type: object
                  systemsurveyor_api:
                    enum:
                    - success
                    - failed
                    type: string
                type: object
          description: OK
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'
      summary: Get site information
      tags:
      - Sites
  /v2/teams/{team_id}/sites:
    get:
      description: Results are sorted by `name` ascending by default if no sorting
        is specified.
      operationId: get_team_sites
      parameters:
      - description: Team ID
        in: path
        name: team_id
        required: true
        schema:
          example: 14875
          type: integer
      - $ref: '#/components/parameters/q'
      - $ref: '#/components/parameters/page'
      - $ref: '#/components/parameters/page_size'
      public: true
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  data:
                    items:
                      properties:
                        city:
                          type: string
                        modified_at:
                          example: 1625170642
                          type: integer
                        name:
                          type: string
                        permission:
                          description: Permission the current logged in user has for
                            the site
                          example: write
                          type: string
                        site_id:
                          example: 46787da3-1e6e-4d9b-a858-ac9e12dc3efb
                          type: string
                        surveys_count:
                          type: integer
                      type: object
                    type: array
                  systemsurveyor_api:
                    enum:
                    - success
                    - failed
                    type: string
                type: object
          description: OK
        '401':
          $ref: '#/components/responses/UnauthorizedError'
      summary: Get team sites the current user has access to
      tags:
      - Sites
  /v2/site/{site_id}/lock:
    delete:
      description: Removes all the current edit locks for all surveys in a site where
        the current user is the editor
      operationId: remove_site_locks
      parameters:
      - description: Site ID
        in: path
        name: site_id
        required: true
        schema:
          example: 40759717-c239-4504-a0a5-7e7f57220995
          type: string
      public: true
      responses:
        '200':
          description: OK
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
      summary: Remove site locks
      tags:
      - Sites
  /v2/site/{site_id}/share:
    post:
      description: An email will be sent to all emails listed in `emails` field with
        instructions on how to access the site.
      operationId: share_site
      parameters:
      - in: path
        name: site_id
        required: true
        schema:
          example: 2bf07f89-306d-4cfa-be60-660bfbf150f8
          type: string
      public: true
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ShareSiteOrSurveyRequestSchema'
        required: true
      responses:
        '200':
          description: OK
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
      summary: Allows users to share a site for other users to see for a given amount
        of time.
      tags:
      - Sites
  /v2/site/{site_id}/surveys:
    get:
      description: 'Surveys that belong to folders will not be included in the response,
        unless

        a search is being made.


        Results are ordered by `name` ascending by default if no sorting is specified.

        '
      operationId: get_site_surveys
      parameters:
      - description: Site ID
        in: path
        name: site_id
        required: true
        schema:
          example: 86af1f1d-4f19-4c6c-afd6-e5ee041666ce
          type: string
      - description: Return only surveys in a specific status (`0` for archived surveys
          or `1` for open surveys).
        in: query
        name: status
        schema:
          enum:
          - 0
          - 1
          type: integer
      - description: Filter surveys by folder using string of external_id (UUID)
        in: query
        name: external_folder_id
        schema:
          example: b14663f6-9ad1-40c0-8a1a-32f2e19b1ccb
          type: string
      - description: Sort by column names (comma separated). Use `-` prefix on column
          name to sort descending
        in: query
        name: sort_by
        schema:
          description: Sort by column names (comma separated). Use `-` prefix on column
            name to sort descending.
          enum:
          - survey_id
          - folder_id
          - name
          - document_image_url
          - editor_id
          - editor_first_name
          - editor_last_name
          - comments_count
          - elements_count
          - is_folder
          - created_at
          - modified_at
          - status
          - survey_count
          example: sort_by=-is_folder,name,editor_first_name
          type: string
      - $ref: '#/components/parameters/q'
      - $ref: '#/components/parameters/page'
      - $ref: '#/components/parameters/page_size'
      public: true
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  count:
                    description: Total count of surveys and folders for the site
                    type: integer
                  data:
                    items:
                      properties:
                        comments_count:
                          type: integer
                        editor:
                          properties:
                            first_name:
                              type: string
                            last_name:
                              type: string
                            user_id:
                              type: integer
                          type: object
                        elements_count:
                          type: integer
                        folder_id:
                          type: string
                        is_archived:
                          type: boolean
                        is_folder:
                          type: boolean
                        label:
                          description: Folder label
                          type: string
                        name:
                          type: string
                        preview_image:
                          description: URL to the survey's preview image
                          type: string
                        survey_count:
                          type: integer
                        survey_id:
                          example: '1233412'
                          type: string
                      type: object
                    type: array
                type: object
          description: OK
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
      summary: Get all surveys and folders for a specific site
      tags:
      - Surveys
  /v2/user/permissions:
    get:
      operationId: get_current_user_permissions
      public: true
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  data:
                    properties:
                      accounts:
                        items:
                          type: object
                        type: array
                      is_active_guest:
                        description: If the user is an active guest on any site
                        type: boolean
                      teams:
                        items:
                          type: object
                        type: array
                    type: object
                  systemsurveyor_api:
                    enum:
                    - success
                    - failed
                    type: string
                type: object
          description: OK
        '401':
          $ref: '#/components/responses/UnauthorizedError'
      summary: Get permissions for the current authenticated user
      tags:
      - Users

